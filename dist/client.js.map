{"version":3,"sources":["webpack:///webpack/bootstrap 706a5273d71fa0ade288","webpack:///./src/client/client.js","webpack:///external \"uws\"","webpack:///./src/lib/message.js","webpack:///external \"lodash\"","webpack:///external \"node-uuid\"","webpack:///external \"event-emitter-extra\""],"names":["Client","options","promiseCallbacks","url","ws","readyState","bindEvents","on","onOpen","bind","onClose","onError","onMessage","emit","code","message","err","data","flags","parse","id","reservedNames","indexOf","name","resolve","reject","_","assign","Error","payload","once","send_","createResponse","isObject","eventName","messageId","setId","then","Promise","send","toString","module","exports","uuid","Message","raw","JSON","n","p","e","i","isResponded_","v4","isUndefined","stringify","console","warn"],"mappings":"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","file":"client.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 706a5273d71fa0ade288","import WebSocket from 'uws';\nimport Message from '../lib/message';\nimport EventEmitter from 'event-emitter-extra';\n\n\nclass Client extends EventEmitter {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tthis.promiseCallbacks = {};\n\t\tthis.options = options;\n\t}\n\n\tconnect(url = 'localhost') {\n\t\tthis.ws = new WebSocket(url, this.options);\n\t\tthis.readyState = this.ws.readyState;\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents() {\n\t\tthis.ws.on('open', this.onOpen.bind(this));\n\t\tthis.ws.on('close', this.onClose.bind(this));\n\t\tthis.ws.on('error', this.onError.bind(this));\n\t\tthis.ws.on('message', this.onMessage.bind(this));\n\t}\n\n\tonOpen() {\n\t\tthis.readyState = this.ws.readyState;\n\t\tthis.emit('open');\n\t}\n\n\n\tonClose(code, message) {\n\t\tthis.readyState = this.ws.readyState;\n\t\tthis.emit('close', code, message);\n\t}\n\n\tonError(err) {\n\t\tthis.readyState = this.ws.readyState;\n\t\tthis.emit('error', err);\n\t}\n\n\tonMessage(data, flags) {\n\t\tconst message = Message.parse(data);\n\n\t\t// Ciplak mesaj, publish\n\t\tif (!message.id && Message.reservedNames.indexOf(message.name) == -1)\n\t\t\treturn this.emit(message.name, message);\n\n\t\t// Bize response geliyor\n\n\t\tif (message.name == '_r') {\n\t\t\tconst {resolve, reject} = this.promiseCallbacks[message.id];\n\n\t\t\tif (message.err) {\n\t\t\t\tconst err = _.assign(new Error(), message.err);\n\t\t\t\treject(err);\n\t\t\t} else {\n\t\t\t\tresolve(message.payload);\n\t\t\t}\n\n\t\t\tdelete this.promiseCallbacks[message.id];\n\t\t\treturn;\n\t\t}\n\n\t\t// Bizden response bekleniyor\n\n\t\tmessage.once('resolved', payload => {\n\t\t\tthis.send_(message.createResponse(null, payload));\n\t\t});\n\n\t\tmessage.once('rejected', err => {\n\t        if (_.isObject(err) && err instanceof Error && err.name == 'Error')\n\t           err = {message: err.message, name: 'Error'};\n\t\t\tthis.send_(message.createResponse(err));\n\t\t});\n\n\t\tthis.emit(message.name, message);\n\t}\n\n\tsend(eventName, payload) {\n\t\tconst message = new Message({name: eventName, payload});\n\t\tconst messageId = message.setId();\n\t\treturn this\n\t\t\t.send_(message)\n\t\t\t.then(_ => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.promiseCallbacks[messageId] = {resolve, reject};\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tsend_(message) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.ws.send(message.toString(), err => {\n\t\t\t\tif (err) return reject(err);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n}\n\nmodule.exports = Client;\n\n\n// WEBPACK FOOTER //\n// ./src/client/client.js","module.exports = require(\"uws\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uws\"\n// module id = 1\n// module chunks = 0","import * as _ from 'lodash';\nimport * as uuid from 'node-uuid';\nimport EventEmitter from 'event-emitter-extra';\n\n\n\nexport default class Message extends EventEmitter {\n\tstatic parse(raw) {\n\t\ttry {\n\t\t\tconst data = JSON.parse(raw);\n\t\t\treturn new Message({\n\t\t\t\tname: data.n,\n\t\t\t\tpayload: data.p,\n\t\t\t\terr: data.e,\n\t\t\t\tid: data.i\n\t\t\t});\n\t\t} catch(err) {\n\t\t\tthrow new Error(`Could not parse message.`);\n\t\t}\n\t}\n\n\tconstructor({name, payload, id, err}) {\n\t\tsuper();\n\n\t\tthis.name = name;\n\t\tthis.payload = payload;\n\t\tthis.id = id;\n\t\tthis.err = err;\n\n\t\tthis.isResponded_ = false;\n\t}\n\n\tsetId(id = uuid.v4()) {\n\t\tthis.id = id;\n\t\treturn id;\n\t}\n\n\ttoString() {\n\t\ttry {\n\t\t\tconst data = {n: this.name};\n\n\t\t\tif (!_.isUndefined(this.payload))\n\t\t\t\tdata.p = this.payload;\n\n\t\t\tif (!_.isUndefined(this.id))\n\t\t\t\tdata.i = this.id;\n\n\t\t\tif (!_.isUndefined(this.err))\n\t\t\t\tdata.e = this.err;\n\n\t\t\treturn JSON.stringify(data);\n\t\t} catch(err) {\n\t\t\tthrow new Error(`Could not stringify message.`);\n\t\t}\n\t}\n\n\tcreateResponse(err, payload) {\n\t\treturn new Message({name: '_r', payload, err, id: this.id});\n\t}\n\n\tresolve(payload) {\n\t\tif (_.isUndefined(this.id))\n\t\t\treturn console.warn('[line] A message without an id cannot be resolved.');\n\n\t\tif (this.isResponded_)\n\t\t\treturn console.warn('[line] This message has already been ended.');\n\n\t\tthis.isResponded_ = true;\n\t\tthis.emit('resolved', payload);\n\t}\n\n\treject(err) {\n\t\tif (_.isUndefined(this.id))\n\t\t\treturn console.warn('[line] A message without an id cannot be rejected.');\n\n\t\tif (this.isResponded_)\n\t\t\treturn console.warn('[line] This message has already been ended.');\n\n\t\tthis.isResponded_ = true;\n\t\tthis.emit('rejected', err);\n\t}\n}\n\nMessage.reservedNames = ['_r'];\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/message.js","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"node-uuid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"node-uuid\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"event-emitter-extra\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"event-emitter-extra\"\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}