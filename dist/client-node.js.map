{"version":3,"sources":["webpack:///client-node.js","webpack:///webpack/bootstrap d25680912d0d4effff3f","webpack:///./src/lib/utils.js","webpack:///external \"event-emitter-extra/dist/commonjs.modern\"","webpack:///./src/client/client-web.js","webpack:///external \"uws\"","webpack:///./src/lib/deferred.js","webpack:///./src/lib/message.js","webpack:///external \"lodash/assign\"","webpack:///external \"lodash/debounce\"","webpack:///external \"lodash/isFunction\"","webpack:///external \"lodash/isObject\"","webpack:///external \"lodash/isUndefined\"","webpack:///external \"lodash/values\"","webpack:///./src/client/client-node.js"],"names":["module","exports","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","value","d","name","getter","Object","defineProperty","configurable","enumerable","get","n","__esModule","o","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","default","promiseDelay","ms","Promise","resolve","setTimeout","_","retry","task","options","arguments","length","undefined","defaults","maxDelay","maxCount","initialDelay","increaseFactor","_assign2","timeout","counter","delay","once","catch","err","clearTimeout","then","generateDummyId","Math","random","pow","toString","slice","_assign","require","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","writable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","descriptor","key","protoProps","staticProps","_message","_message2","_utils","_utils2","_commonjs","_commonjs2","_deferred","_deferred2","_debounce","_debounce2","WebClient","_EventEmitter","url","this","_this","getPrototypeOf","ws_","id","readyState","reconnect","reconnectDisabled_","serverTimeout_","maxReconnectDelay","initialReconnectDelay","reconnectIncrementFactor","pingInterval","deferreds_","connectDeferred_","disconnectDeferred_","state","States","READY","autoPing_","CONNECTED","ping","_this2","CONNECTING","reject","Error","CLOSING","CLOSED","handler","emit","Events","WebSocket","bindEvents_","code","reason","_this3","ERROR","deferred","close","onopen","onOpen","bind","onclose","onClose","onerror","onError","onmessage","onMessage","_this4","send","Names","HANDSHAKE","handshakePayload","data","console","log","disconnect","e","_this5","unBindEvents_","retrying_","connect","eventName","CONNECTING_ERROR","disposeConnectionPromisses_","_this6","message","parse","ReservedNames","indexOf","PING","onPing_","RESPONSE","assign","payload","send_","createResponse","dispose","isObject","_this7","setId","onExpire","_this8","_this9","Deferred","_ref","_ref$handler","_ref$onExpire","_ref$timeout","resolve_","reject_","timeout_","onExpire_","isFinished_","promise","expire","clearTimeout_","_len","args","Array","_key","apply","_len2","_key2","_isUndefined","_isUndefined2","_isObject","_isObject2","_isFunction","_isFunction2","_values","_values2","Message","isResponded_","raw","JSON","warn","response","stringify","events","eventNames","forEach","event","removeAllListeners","_uws","_uws2","_clientWeb","_clientWeb2","global","NodeClient","_WebClient","on"],"mappings":"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","file":"client-node.js","sourcesContent":["module.exports =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmory imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmory exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tObject.defineProperty(exports, name, {\n/******/ \t\t\tconfigurable: false,\n/******/ \t\t\tenumerable: true,\n/******/ \t\t\tget: getter\n/******/ \t\t});\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 12);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\"use strict\";\n\nvar _assign = __webpack_require__(6);\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction promiseDelay(ms) {\n    return new Promise(function (resolve) {\n        return setTimeout(function (_) {\n            return resolve();\n        }, ms);\n    });\n}\n\nfunction retry(task) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var defaults = { maxDelay: 160, maxCount: 0, initialDelay: 3, increaseFactor: 2 };\n    options = (0, _assign2.default)(defaults, options);\n    var timeout = void 0;\n    var counter = 1;\n    var delay = options.initialDelay;\n\n    var once = function once() {\n        return task().catch(function (err) {\n            counter++;\n            delay = delay * options.increaseFactor;\n\n            if (options.maxCount != 0 && counter > options.maxCount) {\n                timeout && clearTimeout(timeout);\n                throw err;\n            }\n            return promiseDelay(delay * 1000 / 2).then(function (_) {\n                return once();\n            });\n        });\n    };\n\n    return once();\n}\n\n// http://stackoverflow.com/a/6248722\nfunction generateDummyId() {\n    var length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 4;\n\n    return (\"0000\" + (Math.random() * Math.pow(36, length) << 0).toString(36)).slice(-length);\n}\n\nmodule.exports = { promiseDelay: promiseDelay, retry: retry, generateDummyId: generateDummyId };\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\nmodule.exports = require(\"event-emitter-extra/dist/commonjs.modern\");\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _message = __webpack_require__(5);\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _utils = __webpack_require__(0);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _commonjs = __webpack_require__(1);\n\nvar _commonjs2 = _interopRequireDefault(_commonjs);\n\nvar _deferred = __webpack_require__(4);\n\nvar _deferred2 = _interopRequireDefault(_deferred);\n\nvar _debounce = __webpack_require__(7);\n\nvar _debounce2 = _interopRequireDefault(_debounce);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar WebClient = function (_EventEmitter) {\n    _inherits(WebClient, _EventEmitter);\n\n    function WebClient() {\n        var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'ws://localhost';\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n        _classCallCheck(this, WebClient);\n\n        var _this = _possibleConstructorReturn(this, (WebClient.__proto__ || Object.getPrototypeOf(WebClient)).call(this));\n\n        _this.url = url;\n\n        _this.options = options;\n\n        _this.ws_ = null;\n        _this.id = null;\n        _this.readyState = null;\n        _this.reconnect = options.reconnect;\n        _this.reconnectDisabled_ = false;\n\n        _this.serverTimeout_ = 30000;\n        _this.maxReconnectDelay = 60;\n        _this.initialReconnectDelay = 1;\n        _this.reconnectIncrementFactor = 2;\n        _this.pingInterval = 60000;\n\n        _this.deferreds_ = {};\n        _this.connectDeferred_ = null;\n        _this.disconnectDeferred_ = null;\n\n        _this.state = WebClient.States.READY;\n\n        _this.autoPing_ = _this.pingInterval > 0 ? (0, _debounce2.default)(function () {\n            if (_this.state != WebClient.States.CONNECTED) return;\n\n            _this.ping().then(function () {\n                if (_this.pingInterval > 0 && _this.state == WebClient.States.CONNECTED) {\n                    _this.autoPing_();\n                }\n            }).catch(function () {});\n        }, _this.pingInterval) : function () {};\n        return _this;\n    }\n\n    _createClass(WebClient, [{\n        key: 'connect',\n        value: function connect() {\n            var _this2 = this;\n\n            switch (this.state) {\n                case WebClient.States.CONNECTING:\n                    return Promise.reject(new Error('Could not connect, already trying to connect to a host...'));\n                case WebClient.States.CONNECTED:\n                    return Promise.reject(new Error('Already connected.'));\n                case WebClient.States.CLOSING:\n                    return Promise.reject(new Error('Terminating an active connecting, try again later.'));\n                case WebClient.States.CLOSED:\n                case WebClient.States.READY:\n                    this.connectDeferred_ = new _deferred2.default({\n                        handler: function handler() {\n                            _this2.state = WebClient.States.CONNECTING;\n                            _this2.emit(WebClient.Events.CONNECTING);\n                            _this2.reconnectDisabled_ = false;\n\n                            setTimeout(function (_) {\n                                _this2.ws_ = new WebSocket(_this2.url);\n                                _this2.bindEvents_();\n                            }, 0);\n                        }\n                    });\n\n                    return this.connectDeferred_;\n                default:\n                    return Promise.reject(new Error('Could not connect, unknown state.'));\n            }\n        }\n    }, {\n        key: 'disconnect',\n        value: function disconnect(code, reason) {\n            var _this3 = this;\n\n            switch (this.state) {\n                case WebClient.States.ERROR:\n                case WebClient.States.CONNECTED:\n                case WebClient.States.CONNECTING:\n                    this.reconnectDisabled_ = true;\n                    var deferred = this.disconnectDeferred_ = new _deferred2.default({\n                        handler: function handler() {\n                            _this3.ws_.close(code, reason);\n                            _this3.state = WebClient.States.CLOSING;\n                        }\n                    });\n                    return deferred;\n                case WebClient.States.CLOSED:\n                    return Promise.reject(new Error('There is no connection to disconnect.'));\n                case WebClient.States.CLOSING:\n                    return Promise.reject(new Error('Already terminating a connecting, try again later.'));\n            }\n        }\n    }, {\n        key: 'bindEvents_',\n        value: function bindEvents_() {\n            this.ws_.onopen = this.onOpen.bind(this);\n            this.ws_.onclose = this.onClose.bind(this);\n            this.ws_.onerror = this.onError.bind(this);\n            this.ws_.onmessage = this.onMessage.bind(this);\n        }\n    }, {\n        key: 'unBindEvents_',\n        value: function unBindEvents_() {\n            if (!this.ws_) return;\n            delete this.ws_.onopen;\n            delete this.ws_.onclose;\n            delete this.ws_.onerror;\n            delete this.ws_.onmessage;\n        }\n    }, {\n        key: 'disposeConnectionPromisses_',\n        value: function disposeConnectionPromisses_() {\n            if (this.connectDeferred_) {\n                this.connectDeferred_.reject();\n                this.connectDeferred_ = null;\n            }\n\n            if (this.disconnectDeferred_) {\n                this.disconnectDeferred_.reject();\n                this.disconnectDeferred_ = null;\n            }\n        }\n    }, {\n        key: 'onOpen',\n        value: function onOpen() {\n            var _this4 = this;\n\n            // this.updateState_();\n            // this.emit('_open');\n            _utils2.default.retry(function (_) {\n                return _this4.send(_message2.default.Names.HANDSHAKE, _this4.options.handshakePayload);\n            }, { maxCount: 3, initialDelay: 1, increaseFactor: 1 }).then(function (data) {\n                _this4.id = data.id;\n                _this4.serverTimeout_ = data.timeout;\n                _this4.maxReconnectDelay = data.maxReconnectDelay;\n                _this4.initialReconnectDelay = data.initialReconnectDelay;\n                _this4.reconnectIncrementFactor = data.reconnectIncrementFactor;\n                _this4.pingInterval = data.pingInterval;\n\n                if (_this4.connectDeferred_) {\n                    _this4.connectDeferred_.resolve(data.handshakePayload);\n                    _this4.connectDeferred_ = null;\n                }\n\n                _this4.state = WebClient.States.CONNECTED;\n                _this4.emit(WebClient.Events.CONNECTED, data.handshakePayload);\n            }).catch(function (err) {\n                console.log('Handshake failed', err);\n                return _this4.disconnect();\n            }).catch(function (err) {\n                console.log('Could not disconnect after failed handshake', err);\n            });\n        }\n    }, {\n        key: 'onClose',\n        value: function onClose(e) {\n            var _this5 = this;\n\n            this.unBindEvents_();\n            this.id = null;\n            this.ws_ = null;\n            this.state = WebClient.States.CLOSED;\n\n            this.emit(WebClient.Events.CLOSED, e.code, e.reason);\n\n            if (this.connectDeferred_) {\n                this.connectDeferred_.reject();\n                this.connectDeferred_ = null;\n            }\n\n            if (this.disconnectDeferred_) {\n                this.disconnectDeferred_.resolve();\n                this.disconnectDeferred_ = null;\n            }\n\n            if (!this.reconnect || this.retrying_ || this.reconnectDisabled_) return;\n\n            this.retrying_ = true;\n            _utils2.default.retry(function (_) {\n                return _this5.connect();\n            }, {\n                maxCount: this.maxReconnectDelay,\n                initialDelay: this.initialReconnectDelay,\n                increaseFactor: this.reconnectIncrementFactor\n            }).then(function (_) {\n                _this5.retrying_ = false;\n            });\n        }\n    }, {\n        key: 'onError',\n        value: function onError(err) {\n            var eventName = this.state == WebClient.States.CONNECTING ? WebClient.Events.CONNECTING_ERROR : WebClient.Events.ERROR;\n\n            this.state = WebClient.States.CLOSED;\n\n            this.emit(eventName, err);\n            this.disposeConnectionPromisses_();\n        }\n    }, {\n        key: 'onMessage',\n        value: function onMessage(e) {\n            var _this6 = this;\n\n            var message = _message2.default.parse(e.data);\n\n            this.autoPing_();\n\n            // Message without response (no id fields)\n            if (!message.id && _message2.default.ReservedNames.indexOf(message.name) == -1) return this.emit(message.name, message);\n\n            // Ping\n            if (message.name == _message2.default.Names.PING) {\n                return this.onPing_(message);\n            }\n\n            // Message response\n            if (message.name == _message2.default.Names.RESPONSE && this.deferreds_[message.id]) {\n                var deferred = this.deferreds_[message.id];\n\n                if (message.err) {\n                    var err = Object.assign(new Error(), message.err);\n                    deferred.reject(err);\n                } else {\n                    deferred.resolve(message.payload);\n                }\n\n                delete this.deferreds_[message.id];\n                return;\n            }\n\n            // Message with response\n            message.once('resolved', function (payload) {\n                _this6.send_(message.createResponse(null, payload));\n                message.dispose();\n            });\n\n            message.once('rejected', function (err) {\n                if (_.isObject(err) && err instanceof Error && err.name == 'Error') err = { message: err.message, name: 'Error' };\n                _this6.send_(message.createResponse(err));\n                message.dispose();\n            });\n\n            this.emit(message.name, message);\n        }\n    }, {\n        key: 'onPing_',\n        value: function onPing_(message) {\n            this.send_(message.createResponse(null, 'pong')).catch(function (err) {\n                console.log('Ping responce failed to send', err);\n            });\n        }\n    }, {\n        key: 'send',\n        value: function send(eventName, payload) {\n            var _this7 = this;\n\n            var message = new _message2.default({ name: eventName, payload: payload });\n            message.setId();\n\n            return this.send_(message).then(function (_) {\n                var deferred = _this7.deferreds_[message.id] = new _deferred2.default({\n                    onExpire: function onExpire() {\n                        delete _this7.deferreds_[message.id];\n                    },\n                    timeout: _this7.serverTimeout_\n                });\n\n                return deferred;\n            });\n        }\n    }, {\n        key: 'sendWithoutResponse',\n        value: function sendWithoutResponse(eventName, payload) {\n            var message = new _message2.default({ name: eventName, payload: payload });\n            return this.send_(message);\n        }\n    }, {\n        key: 'send_',\n        value: function send_(message) {\n            var _this8 = this;\n\n            return new Promise(function (resolve) {\n                _this8.ws_.send(message.toString());\n                resolve();\n            });\n        }\n    }, {\n        key: 'ping',\n        value: function ping() {\n            var _this9 = this;\n\n            return _utils2.default.retry(function (_) {\n                return _this9.send(_message2.default.Names.PING);\n            }, { maxCount: 3, initialDelay: 1, increaseFactor: 1 }).catch(function (err) {\n                _this9.disconnect();\n                throw err;\n            });\n        }\n    }]);\n\n    return WebClient;\n}(_commonjs2.default);\n\nWebClient.States = {\n    READY: -1,\n    CONNECTING: 0,\n    CONNECTED: 1,\n    CLOSING: 2,\n    CLOSED: 3\n};\n\nWebClient.Events = {\n    READY: '_ready',\n    CONNECTING: '_connecting',\n    CONNECTING_ERROR: '_connecting_error',\n    CONNECTED: '_connected',\n    CLOSING: '_closing',\n    CLOSED: '_closed',\n    ERROR: '_error'\n};\n\nmodule.exports = WebClient;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\nmodule.exports = require(\"uws\");\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\"use strict\";\n'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Deferred = function () {\n    function Deferred() {\n        var _this = this;\n\n        var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n            _ref$handler = _ref.handler,\n            handler = _ref$handler === undefined ? function () {} : _ref$handler,\n            _ref$onExpire = _ref.onExpire,\n            onExpire = _ref$onExpire === undefined ? function () {} : _ref$onExpire,\n            _ref$timeout = _ref.timeout,\n            timeout = _ref$timeout === undefined ? 0 : _ref$timeout;\n\n        _classCallCheck(this, Deferred);\n\n        this.resolve_ = null;\n        this.reject_ = null;\n\n        this.timeout_ = null;\n        this.onExpire_ = onExpire;\n        this.isFinished_ = false;\n\n        this.promise = new Promise(function (resolve, reject) {\n            _this.resolve_ = resolve;\n            _this.reject_ = reject;\n\n            try {\n                handler(_this);\n            } catch (err) {\n                _this.reject(err);\n            }\n        });\n\n        if (timeout > 0) {\n            this.timeout_ = setTimeout(this.expire.bind(this), timeout);\n        }\n    }\n\n    _createClass(Deferred, [{\n        key: 'resolve',\n        value: function resolve(data) {\n            if (this.isFinished_) return;\n\n            this.isFinished_ = true;\n            this.clearTimeout_();\n            this.resolve_(data);\n        }\n    }, {\n        key: 'reject',\n        value: function reject(err) {\n            if (this.isFinished_) return;\n\n            this.isFinished_ = true;\n            this.clearTimeout_();\n            this.reject_(err);\n        }\n    }, {\n        key: 'expire',\n        value: function expire() {\n            this.isFinished_ = true;\n            this.clearTimeout_();\n            this.onExpire_();\n            this.reject_(new Error('Timeout exceed'));\n        }\n    }, {\n        key: 'then',\n        value: function then() {\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            return this.promise.then.apply(this.promise, args);\n        }\n    }, {\n        key: 'catch',\n        value: function _catch() {\n            for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                args[_key2] = arguments[_key2];\n            }\n\n            return this.promise.catch.apply(this.promise, args);\n        }\n    }, {\n        key: 'clearTimeout_',\n        value: function clearTimeout_() {\n            if (this.timeout_) {\n                clearTimeout(this.timeout_);\n                this.timeout_ = null;\n            }\n        }\n    }]);\n\n    return Deferred;\n}();\n\nmodule.exports = Deferred;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _isUndefined = __webpack_require__(10);\n\nvar _isUndefined2 = _interopRequireDefault(_isUndefined);\n\nvar _isObject = __webpack_require__(9);\n\nvar _isObject2 = _interopRequireDefault(_isObject);\n\nvar _isFunction = __webpack_require__(8);\n\nvar _isFunction2 = _interopRequireDefault(_isFunction);\n\nvar _values = __webpack_require__(11);\n\nvar _values2 = _interopRequireDefault(_values);\n\nvar _utils = __webpack_require__(0);\n\nvar _commonjs = __webpack_require__(1);\n\nvar _commonjs2 = _interopRequireDefault(_commonjs);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Message = function (_EventEmitter) {\n    _inherits(Message, _EventEmitter);\n\n    _createClass(Message, null, [{\n        key: 'parse',\n        value: function parse(raw) {\n            try {\n                var data = JSON.parse(raw);\n                return new Message({\n                    name: data.n,\n                    payload: data.p,\n                    err: data.e,\n                    id: data.i\n                });\n            } catch (err) {\n                throw new Error('Could not parse message.');\n            }\n        }\n    }]);\n\n    function Message(_ref) {\n        var name = _ref.name,\n            payload = _ref.payload,\n            id = _ref.id,\n            err = _ref.err;\n\n        _classCallCheck(this, Message);\n\n        var _this = _possibleConstructorReturn(this, (Message.__proto__ || Object.getPrototypeOf(Message)).call(this));\n\n        _this.name = name;\n        _this.payload = payload;\n        _this.id = id;\n        _this.err = err;\n\n        _this.isResponded_ = false;\n        return _this;\n    }\n\n    _createClass(Message, [{\n        key: 'setId',\n        value: function setId() {\n            var id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : (0, _utils.generateDummyId)();\n\n            this.id = id;\n            return id;\n        }\n    }, {\n        key: 'createResponse',\n        value: function createResponse(err, payload) {\n            return new Message({ name: '_r', payload: payload, err: err, id: this.id });\n        }\n    }, {\n        key: 'resolve',\n        value: function resolve(payload) {\n            var _this2 = this;\n\n            if ((0, _isUndefined2.default)(this.id)) return console.warn('[line] A message without an id cannot be resolved.');\n\n            if (this.isResponded_) return console.warn('[line] This message has already been ended.');\n\n            // If thenable\n            if ((0, _isObject2.default)(payload) && (0, _isFunction2.default)(payload.then)) {\n                payload.then(function (response) {\n                    _this2.isResponded_ = true;\n                    _this2.emit('resolved', payload);\n                }).catch(function (err) {\n                    _this2.isResponded_ = true;\n                    _this2.emit('rejected', err);\n                });\n\n                return;\n            }\n\n            this.isResponded_ = true;\n            this.emit('resolved', payload);\n        }\n    }, {\n        key: 'reject',\n        value: function reject(err) {\n            if ((0, _isUndefined2.default)(this.id)) return console.warn('[line] A message without an id cannot be rejected.');\n\n            if (this.isResponded_) return console.warn('[line] This message has already been ended.');\n\n            this.isResponded_ = true;\n            this.emit('rejected', err);\n        }\n    }, {\n        key: 'toString',\n        value: function toString() {\n            try {\n                var data = { n: this.name };\n\n                if (!(0, _isUndefined2.default)(this.payload)) data.p = this.payload;\n\n                if (!(0, _isUndefined2.default)(this.id)) data.i = this.id;\n\n                if (!(0, _isUndefined2.default)(this.err)) data.e = this.err;\n\n                return JSON.stringify(data);\n            } catch (err) {\n                throw new Error('Could not stringify message.');\n            }\n        }\n    }, {\n        key: 'dispose',\n        value: function dispose() {\n            var _this3 = this;\n\n            var events = this.eventNames();\n            events.forEach(function (event) {\n                return _this3.removeAllListeners(event);\n            });\n        }\n    }]);\n\n    return Message;\n}(_commonjs2.default);\n\nexports.default = Message;\n\n\nMessage.Names = {\n    RESPONSE: '_r',\n    HANDSHAKE: '_h',\n    PING: '_p'\n};\n\nMessage.ReservedNames = (0, _values2.default)(Message.Names);\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\nmodule.exports = require(\"lodash/assign\");\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\nmodule.exports = require(\"lodash/debounce\");\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\nmodule.exports = require(\"lodash/isFunction\");\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\nmodule.exports = require(\"lodash/isObject\");\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\nmodule.exports = require(\"lodash/isUndefined\");\n\n/***/ },\n/* 11 */\n/***/ function(module, exports) {\n\nmodule.exports = require(\"lodash/values\");\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _uws = __webpack_require__(3);\n\nvar _uws2 = _interopRequireDefault(_uws);\n\nvar _clientWeb = __webpack_require__(2);\n\nvar _clientWeb2 = _interopRequireDefault(_clientWeb);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nglobal.WebSocket = _uws2.default;\n\nvar NodeClient = function (_WebClient) {\n    _inherits(NodeClient, _WebClient);\n\n    function NodeClient() {\n        _classCallCheck(this, NodeClient);\n\n        return _possibleConstructorReturn(this, (NodeClient.__proto__ || Object.getPrototypeOf(NodeClient)).apply(this, arguments));\n    }\n\n    _createClass(NodeClient, [{\n        key: 'bindEvents_',\n        value: function bindEvents_() {\n            var _this2 = this;\n\n            this.ws_.on('open', this.onOpen.bind(this));\n            this.ws_.on('error', this.onError.bind(this));\n\n            this.ws_.on('close', function (code, reason) {\n                _this2.onClose({ code: code, reason: reason });\n            });\n\n            this.ws_.on('message', function (data) {\n                _this2.onMessage({ data: data });\n            });\n        }\n    }, {\n        key: 'send_',\n        value: function send_(message) {\n            var _this3 = this;\n\n            return new Promise(function (resolve, reject) {\n                _this3.ws_.send(message.toString(), function (err) {\n                    if (err) return reject(err);\n                    resolve();\n                });\n            });\n        }\n    }]);\n\n    return NodeClient;\n}(_clientWeb2.default);\n\nmodule.exports = NodeClient;\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// client-node.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 12);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d25680912d0d4effff3f","import assign from 'lodash/assign';\n\n\nfunction promiseDelay(ms) {\n    return new Promise(resolve => setTimeout(_ => resolve(), ms))\n}\n\n\nfunction retry(task, options = {}) {\n    const defaults = {maxDelay: 160, maxCount: 0, initialDelay: 3, increaseFactor: 2};\n    options = assign(defaults, options);\n    let timeout;\n    let counter = 1;\n    let delay = options.initialDelay;\n\n    const once = function() {\n        return task()\n            .catch(err => {\n                counter++;\n                delay = delay * options.increaseFactor;\n\n                if (options.maxCount != 0 && counter > options.maxCount) {\n                    timeout && clearTimeout(timeout);\n                    throw err;\n                }\n                return promiseDelay(delay * 1000 / 2).then(_ => once());\n            });\n    }\n\n    return once();\n}\n\n\n// http://stackoverflow.com/a/6248722\nfunction generateDummyId(length = 4) {\n    return (\"0000\" + (Math.random()*Math.pow(36,length) << 0).toString(36)).slice(-length);\n}\n\n\nmodule.exports = {promiseDelay, retry, generateDummyId};\n\n\n// WEBPACK FOOTER //\n// ./src/lib/utils.js","module.exports = require(\"event-emitter-extra/dist/commonjs.modern\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"event-emitter-extra/dist/commonjs.modern\"\n// module id = 1\n// module chunks = 0","import Message from '../lib/message';\nimport Utils from '../lib/utils';\nimport EventEmitter from 'event-emitter-extra/dist/commonjs.modern';\nimport Deferred from '../lib/deferred';\nimport debounce from 'lodash/debounce';\n\n\nclass WebClient extends EventEmitter {\n    constructor(url = 'ws://localhost', options = {}) {\n        super();\n\n        this.url = url;\n\n        this.options = options;\n\n        this.ws_ = null;\n        this.id = null;\n        this.readyState = null;\n        this.reconnect = options.reconnect;\n        this.reconnectDisabled_ = false;\n\n        this.serverTimeout_ = 30000;\n        this.maxReconnectDelay = 60;\n        this.initialReconnectDelay = 1;\n        this.reconnectIncrementFactor = 2;\n        this.pingInterval = 60000;\n\n        this.deferreds_ = {};\n        this.connectDeferred_ = null;\n        this.disconnectDeferred_ = null;\n\n        this.state = WebClient.States.READY;\n\n        this.autoPing_ = this.pingInterval > 0 ?\n            debounce(() => {\n                if (this.state != WebClient.States.CONNECTED)\n                    return;\n\n                this\n                    .ping()\n                    .then(() => {\n                        if (this.pingInterval > 0 && this.state == WebClient.States.CONNECTED) {\n                            this.autoPing_();\n                        }\n                    })\n                    .catch(() => {});\n            }, this.pingInterval) :\n            () => {};\n    }\n\n\n    connect() {\n        switch (this.state) {\n            case WebClient.States.CONNECTING:\n                return Promise.reject(new Error('Could not connect, already trying to connect to a host...'));\n            case WebClient.States.CONNECTED:\n                return Promise.reject(new Error('Already connected.'));\n            case WebClient.States.CLOSING:\n                return Promise.reject(new Error('Terminating an active connecting, try again later.'));\n            case WebClient.States.CLOSED:\n            case WebClient.States.READY:\n                this.connectDeferred_ = new Deferred({\n                    handler: () => {\n                        this.state = WebClient.States.CONNECTING;\n                        this.emit(WebClient.Events.CONNECTING);\n                        this.reconnectDisabled_ = false;\n\n                        setTimeout(_ => {\n                            this.ws_ = new WebSocket(this.url);\n                            this.bindEvents_();\n                        }, 0);\n                    }\n                });\n\n                return this.connectDeferred_;\n            default:\n                return Promise.reject(new Error('Could not connect, unknown state.'))\n        }\n    }\n\n\n    disconnect(code, reason) {\n        switch (this.state) {\n            case WebClient.States.ERROR:\n            case WebClient.States.CONNECTED:\n            case WebClient.States.CONNECTING:\n                this.reconnectDisabled_ = true;\n                const deferred = this.disconnectDeferred_ = new Deferred({\n                    handler: () => {\n                        this.ws_.close(code, reason);\n                        this.state = WebClient.States.CLOSING;\n                    }\n                });\n                return deferred;\n            case WebClient.States.CLOSED:\n                return Promise.reject(new Error('There is no connection to disconnect.'));\n            case WebClient.States.CLOSING:\n                return Promise.reject(new Error('Already terminating a connecting, try again later.'));\n        }\n    }\n\n\n    bindEvents_() {\n        this.ws_.onopen = this.onOpen.bind(this);\n        this.ws_.onclose = this.onClose.bind(this);\n        this.ws_.onerror = this.onError.bind(this);\n        this.ws_.onmessage = this.onMessage.bind(this);\n    }\n\n\n    unBindEvents_() {\n        if (!this.ws_) return;\n        delete this.ws_.onopen;\n        delete this.ws_.onclose;\n        delete this.ws_.onerror;\n        delete this.ws_.onmessage;\n    }\n\n\n    disposeConnectionPromisses_() {\n        if (this.connectDeferred_) {\n            this.connectDeferred_.reject();\n            this.connectDeferred_ = null;\n        }\n\n        if (this.disconnectDeferred_) {\n            this.disconnectDeferred_.reject();\n            this.disconnectDeferred_ = null;\n        }\n    }\n\n\n    onOpen() {\n        // this.updateState_();\n        // this.emit('_open');\n        Utils.retry(_ => this.send(Message.Names.HANDSHAKE, this.options.handshakePayload), {maxCount: 3, initialDelay: 1, increaseFactor: 1})\n            .then(data => {\n                this.id = data.id;\n                this.serverTimeout_ = data.timeout;\n                this.maxReconnectDelay = data.maxReconnectDelay;\n                this.initialReconnectDelay = data.initialReconnectDelay;\n                this.reconnectIncrementFactor = data.reconnectIncrementFactor;\n                this.pingInterval = data.pingInterval;\n\n                if (this.connectDeferred_) {\n                    this.connectDeferred_.resolve(data.handshakePayload);\n                    this.connectDeferred_ = null;\n                }\n\n                this.state = WebClient.States.CONNECTED;\n                this.emit(WebClient.Events.CONNECTED, data.handshakePayload);\n            })\n            .catch(err => {\n                console.log('Handshake failed', err);\n                return this.disconnect();\n            })\n            .catch(err => {\n                console.log('Could not disconnect after failed handshake', err);\n            });\n    }\n\n\n    onClose(e) {\n        this.unBindEvents_();\n        this.id = null;\n        this.ws_ = null;\n        this.state = WebClient.States.CLOSED;\n\n        this.emit(WebClient.Events.CLOSED, e.code, e.reason);\n\n        if (this.connectDeferred_) {\n            this.connectDeferred_.reject();\n            this.connectDeferred_ = null;\n        }\n\n        if (this.disconnectDeferred_) {\n            this.disconnectDeferred_.resolve();\n            this.disconnectDeferred_ = null;\n        }\n\n        if (!this.reconnect || this.retrying_ || this.reconnectDisabled_) return;\n\n        this.retrying_ = true;\n        Utils\n            .retry(\n                _ => this.connect(),\n                {\n                    maxCount: this.maxReconnectDelay,\n                    initialDelay: this.initialReconnectDelay,\n                    increaseFactor: this.reconnectIncrementFactor\n                })\n            .then(_ => {\n                this.retrying_ = false;\n            });\n    }\n\n\n    onError(err) {\n        const eventName = this.state == WebClient.States.CONNECTING ?\n                WebClient.Events.CONNECTING_ERROR : WebClient.Events.ERROR;\n\n        this.state = WebClient.States.CLOSED;\n\n        this.emit(eventName, err);\n        this.disposeConnectionPromisses_();\n    }\n\n\n    onMessage(e) {\n        const message = Message.parse(e.data);\n\n        this.autoPing_();\n\n        // Message without response (no id fields)\n        if (!message.id && Message.ReservedNames.indexOf(message.name) == -1)\n            return this.emit(message.name, message);\n\n        // Ping\n        if (message.name == Message.Names.PING) {\n            return this.onPing_(message);\n        }\n\n        // Message response\n        if (message.name == Message.Names.RESPONSE && this.deferreds_[message.id]) {\n            const deferred = this.deferreds_[message.id];\n\n            if (message.err) {\n                const err = Object.assign(new Error(), message.err);\n                deferred.reject(err);\n            } else {\n                deferred.resolve(message.payload);\n            }\n\n            delete this.deferreds_[message.id];\n            return;\n        }\n\n        // Message with response\n        message.once('resolved', payload => {\n            this.send_(message.createResponse(null, payload));\n            message.dispose();\n        });\n\n        message.once('rejected', err => {\n            if (_.isObject(err) && err instanceof Error && err.name == 'Error')\n               err = {message: err.message, name: 'Error'};\n            this.send_(message.createResponse(err));\n            message.dispose();\n        });\n\n        this.emit(message.name, message);\n    }\n\n\n    onPing_(message) {\n        this\n            .send_(message.createResponse(null, 'pong'))\n            .catch(err => {\n                console.log('Ping responce failed to send', err);\n            });\n    }\n\n\n    send(eventName, payload) {\n        const message = new Message({name: eventName, payload});\n        message.setId();\n\n        return this\n            .send_(message)\n            .then(_ => {\n                const deferred = this.deferreds_[message.id] = new Deferred({\n                    onExpire: () => {\n                        delete this.deferreds_[message.id];\n                    },\n                    timeout: this.serverTimeout_\n                });\n\n                return deferred;\n            });\n    }\n\n\n    sendWithoutResponse(eventName, payload) {\n        const message = new Message({name: eventName, payload});\n        return this.send_(message);\n    }\n\n\n    send_(message) {\n        return new Promise(resolve => {\n            this.ws_.send(message.toString());\n            resolve();\n        });\n    }\n\n\n    ping() {\n        return Utils\n            .retry(_ => this.send(Message.Names.PING), {maxCount: 3, initialDelay: 1, increaseFactor: 1})\n            .catch(err => {\n                this.disconnect();\n                throw err;\n            });\n    }\n}\n\nWebClient.States = {\n    READY: -1,\n    CONNECTING: 0,\n    CONNECTED: 1,\n    CLOSING: 2,\n    CLOSED: 3\n};\n\nWebClient.Events = {\n    READY: '_ready',\n    CONNECTING: '_connecting',\n    CONNECTING_ERROR: '_connecting_error',\n    CONNECTED: '_connected',\n    CLOSING: '_closing',\n    CLOSED: '_closed',\n    ERROR: '_error'\n};\n\n\nmodule.exports = WebClient;\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/client-web.js","module.exports = require(\"uws\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uws\"\n// module id = 3\n// module chunks = 0","class Deferred {\n    constructor({\n        handler = () => {},\n        onExpire = () => {},\n        timeout = 0\n    } = {}) {\n        this.resolve_ = null;\n        this.reject_ = null;\n\n        this.timeout_ = null;\n        this.onExpire_ = onExpire;\n        this.isFinished_ = false;\n\n        this.promise = new Promise((resolve, reject) => {\n            this.resolve_ = resolve;\n            this.reject_ = reject;\n\n            try {\n                handler(this);\n            } catch (err) {\n                this.reject(err);\n            }\n        });\n\n        if (timeout > 0) {\n            this.timeout_ = setTimeout(this.expire.bind(this), timeout);\n        }\n    }\n\n\n    resolve(data) {\n        if (this.isFinished_) return;\n\n        this.isFinished_ = true;\n        this.clearTimeout_();\n        this.resolve_(data);\n    }\n\n\n    reject(err) {\n        if (this.isFinished_) return;\n\n        this.isFinished_ = true;\n        this.clearTimeout_();\n        this.reject_(err);\n    }\n\n\n    expire() {\n        this.isFinished_ = true;\n        this.clearTimeout_();\n        this.onExpire_();\n        this.reject_(new Error('Timeout exceed'));\n    }\n\n\n    then(...args) {\n        return this.promise.then.apply(this.promise, args);\n    }\n\n\n    catch(...args) {\n        return this.promise.catch.apply(this.promise, args);\n    }\n\n\n    clearTimeout_() {\n        if (this.timeout_) {\n            clearTimeout(this.timeout_);\n            this.timeout_ = null;\n        }\n    }\n}\n\n\nmodule.exports = Deferred;\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/deferred.js","import isUndefined from 'lodash/isUndefined';\nimport isObject from 'lodash/isObject';\nimport isFunction from 'lodash/isFunction';\nimport values from 'lodash/values';\nimport {generateDummyId} from './utils';\nimport EventEmitter from 'event-emitter-extra/dist/commonjs.modern';\n\n\n\nexport default class Message extends EventEmitter {\n    static parse(raw) {\n        try {\n            const data = JSON.parse(raw);\n            return new Message({\n                name: data.n,\n                payload: data.p,\n                err: data.e,\n                id: data.i\n            });\n        } catch(err) {\n            throw new Error(`Could not parse message.`);\n        }\n    }\n\n    constructor({name, payload, id, err}) {\n        super();\n\n        this.name = name;\n        this.payload = payload;\n        this.id = id;\n        this.err = err;\n\n        this.isResponded_ = false;\n    }\n\n    setId(id = generateDummyId()) {\n        this.id = id;\n        return id;\n    }\n\n    createResponse(err, payload) {\n        return new Message({name: '_r', payload, err, id: this.id});\n    }\n\n    resolve(payload) {\n        if (isUndefined(this.id))\n            return console.warn('[line] A message without an id cannot be resolved.');\n\n        if (this.isResponded_)\n            return console.warn('[line] This message has already been ended.');\n\n        // If thenable\n        if (isObject(payload) && isFunction(payload.then)) {\n            payload\n                .then(response => {\n                    this.isResponded_ = true;\n                    this.emit('resolved', payload);\n                })\n                .catch(err => {\n                    this.isResponded_ = true;\n                    this.emit('rejected', err);\n                });\n\n            return;\n        }\n\n        this.isResponded_ = true;\n        this.emit('resolved', payload);\n    }\n\n    reject(err) {\n        if (isUndefined(this.id))\n            return console.warn('[line] A message without an id cannot be rejected.');\n\n        if (this.isResponded_)\n            return console.warn('[line] This message has already been ended.');\n\n        this.isResponded_ = true;\n        this.emit('rejected', err);\n    }\n\n    toString() {\n        try {\n            const data = {n: this.name};\n\n            if (!isUndefined(this.payload))\n                data.p = this.payload;\n\n            if (!isUndefined(this.id))\n                data.i = this.id;\n\n            if (!isUndefined(this.err))\n                data.e = this.err;\n\n            return JSON.stringify(data);\n        } catch(err) {\n            throw new Error(`Could not stringify message.`);\n        }\n    }\n\n    dispose() {\n        const events = this.eventNames();\n        events.forEach(event => this.removeAllListeners(event));\n    }\n}\n\n\nMessage.Names = {\n    RESPONSE: '_r',\n    HANDSHAKE: '_h',\n    PING: '_p'\n};\n\n\nMessage.ReservedNames = values(Message.Names);\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/message.js","module.exports = require(\"lodash/assign\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/assign\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"lodash/debounce\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/debounce\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"lodash/isFunction\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/isFunction\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"lodash/isObject\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/isObject\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"lodash/isUndefined\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/isUndefined\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"lodash/values\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/values\"\n// module id = 11\n// module chunks = 0","import WebSocket from 'uws';\nimport WebClient from './client-web';\nglobal.WebSocket = WebSocket;\n\n\nclass NodeClient extends WebClient {\n    bindEvents_() {\n        this.ws_.on('open', this.onOpen.bind(this));\n        this.ws_.on('error', this.onError.bind(this));\n\n        this.ws_.on('close', (code, reason) => {\n            this.onClose({code, reason});\n        });\n\n        this.ws_.on('message', (data) => {\n            this.onMessage({data});\n        });\n    }\n\n\n    send_(message) {\n        return new Promise((resolve, reject) => {\n            this.ws_.send(message.toString(), err => {\n                if (err) return reject(err);\n                resolve();\n            });\n        });\n    }\n}\n\n\nmodule.exports = NodeClient;\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/client-node.js"],"sourceRoot":""}