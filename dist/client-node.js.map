{"version":3,"sources":["webpack:///client-node.js","webpack:///webpack/bootstrap e2f551946c8e2722350e","webpack:///./src/client/client-node.js","webpack:///external \"event-emitter-extra\"","webpack:///./src/lib/message.js","webpack:///external \"lodash/isUndefined\"","webpack:///external \"node-uuid\"","webpack:///external \"uws\""],"names":["module","exports","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","_uws","_uws2","_message","_message2","_eventEmitterExtra","_eventEmitterExtra2","Client","_EventEmitter","options","this","_this","getPrototypeOf","promiseCallbacks","url","arguments","undefined","ws","readyState","bindEvents","on","onOpen","bind","onClose","onError","onMessage","emit","code","message","err","data","flags","_this2","parse","reservedNames","indexOf","name","_promiseCallbacks$mes","resolve","reject","_","assign","Error","payload","once","send_","createResponse","dispose","isObject","eventName","_this3","messageId","setId","then","Promise","_this4","send","toString","require","_interopRequireWildcard","newObj","hasOwnProperty","_isUndefined","_isUndefined2","_nodeUuid","uuid","Message","_ref","isResponded_","raw","JSON","n","e","v4","console","warn","stringify","events","eventNames","forEach","event","removeAllListeners"],"mappings":"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","file":"client-node.js","sourcesContent":["module.exports =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _uws = __webpack_require__(5);\n\t\n\tvar _uws2 = _interopRequireDefault(_uws);\n\t\n\tvar _message = __webpack_require__(2);\n\t\n\tvar _message2 = _interopRequireDefault(_message);\n\t\n\tvar _eventEmitterExtra = __webpack_require__(1);\n\t\n\tvar _eventEmitterExtra2 = _interopRequireDefault(_eventEmitterExtra);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Client = function (_EventEmitter) {\n\t\t_inherits(Client, _EventEmitter);\n\t\n\t\tfunction Client(options) {\n\t\t\t_classCallCheck(this, Client);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (Client.__proto__ || Object.getPrototypeOf(Client)).call(this));\n\t\n\t\t\t_this.promiseCallbacks = {};\n\t\t\t_this.options = options;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Client, [{\n\t\t\tkey: 'connect',\n\t\t\tvalue: function connect() {\n\t\t\t\tvar url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'localhost';\n\t\n\t\t\t\tthis.ws = new _uws2.default(url, this.options);\n\t\t\t\tthis.readyState = this.ws.readyState;\n\t\t\t\tthis.bindEvents();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'bindEvents',\n\t\t\tvalue: function bindEvents() {\n\t\t\t\tthis.ws.on('open', this.onOpen.bind(this));\n\t\t\t\tthis.ws.on('close', this.onClose.bind(this));\n\t\t\t\tthis.ws.on('error', this.onError.bind(this));\n\t\t\t\tthis.ws.on('message', this.onMessage.bind(this));\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'onOpen',\n\t\t\tvalue: function onOpen() {\n\t\t\t\tthis.readyState = this.ws.readyState;\n\t\t\t\tthis.emit('_open');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'onClose',\n\t\t\tvalue: function onClose(code, message) {\n\t\t\t\tthis.readyState = this.ws.readyState;\n\t\t\t\tthis.emit('_close', code, message);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'onError',\n\t\t\tvalue: function onError(err) {\n\t\t\t\tthis.readyState = this.ws.readyState;\n\t\t\t\tthis.emit('_error', err);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'onMessage',\n\t\t\tvalue: function onMessage(data, flags) {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tvar message = _message2.default.parse(data);\n\t\n\t\t\t\t// Message without response (no id fields)\n\t\t\t\tif (!message.id && _message2.default.reservedNames.indexOf(message.name) == -1) return this.emit(message.name, message);\n\t\n\t\t\t\t// Message response\n\t\t\t\tif (message.name == '_r') {\n\t\t\t\t\tvar _promiseCallbacks$mes = this.promiseCallbacks[message.id],\n\t\t\t\t\t    resolve = _promiseCallbacks$mes.resolve,\n\t\t\t\t\t    reject = _promiseCallbacks$mes.reject;\n\t\n\t\n\t\t\t\t\tif (message.err) {\n\t\t\t\t\t\tvar err = _.assign(new Error(), message.err);\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(message.payload);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tdelete this.promiseCallbacks[message.id];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\t// Message with response\n\t\t\t\tmessage.once('resolved', function (payload) {\n\t\t\t\t\t_this2.send_(message.createResponse(null, payload));\n\t\t\t\t\tmessage.dispose();\n\t\t\t\t});\n\t\n\t\t\t\tmessage.once('rejected', function (err) {\n\t\t\t\t\tif (_.isObject(err) && err instanceof Error && err.name == 'Error') err = { message: err.message, name: 'Error' };\n\t\t\t\t\t_this2.send_(message.createResponse(err));\n\t\t\t\t\tmessage.dispose();\n\t\t\t\t});\n\t\n\t\t\t\tthis.emit(message.name, message);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'send',\n\t\t\tvalue: function send(eventName, payload) {\n\t\t\t\tvar _this3 = this;\n\t\n\t\t\t\tvar message = new _message2.default({ name: eventName, payload: payload });\n\t\t\t\tvar messageId = message.setId();\n\t\t\t\treturn this.send_(message).then(function (_) {\n\t\t\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t\t\t_this3.promiseCallbacks[messageId] = { resolve: resolve, reject: reject };\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'send_',\n\t\t\tvalue: function send_(message) {\n\t\t\t\tvar _this4 = this;\n\t\n\t\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t\t_this4.ws.send(message.toString(), function (err) {\n\t\t\t\t\t\tif (err) return reject(err);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Client;\n\t}(_eventEmitterExtra2.default);\n\t\n\tmodule.exports = Client;\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"event-emitter-extra\");\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _isUndefined = __webpack_require__(3);\n\t\n\tvar _isUndefined2 = _interopRequireDefault(_isUndefined);\n\t\n\tvar _nodeUuid = __webpack_require__(4);\n\t\n\tvar uuid = _interopRequireWildcard(_nodeUuid);\n\t\n\tvar _eventEmitterExtra = __webpack_require__(1);\n\t\n\tvar _eventEmitterExtra2 = _interopRequireDefault(_eventEmitterExtra);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Message = function (_EventEmitter) {\n\t\t_inherits(Message, _EventEmitter);\n\t\n\t\t_createClass(Message, null, [{\n\t\t\tkey: 'parse',\n\t\t\tvalue: function parse(raw) {\n\t\t\t\ttry {\n\t\t\t\t\tvar data = JSON.parse(raw);\n\t\t\t\t\treturn new Message({\n\t\t\t\t\t\tname: data.n,\n\t\t\t\t\t\tpayload: data.p,\n\t\t\t\t\t\terr: data.e,\n\t\t\t\t\t\tid: data.i\n\t\t\t\t\t});\n\t\t\t\t} catch (err) {\n\t\t\t\t\tthrow new Error('Could not parse message.');\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\t\n\t\tfunction Message(_ref) {\n\t\t\tvar name = _ref.name,\n\t\t\t    payload = _ref.payload,\n\t\t\t    id = _ref.id,\n\t\t\t    err = _ref.err;\n\t\n\t\t\t_classCallCheck(this, Message);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (Message.__proto__ || Object.getPrototypeOf(Message)).call(this));\n\t\n\t\t\t_this.name = name;\n\t\t\t_this.payload = payload;\n\t\t\t_this.id = id;\n\t\t\t_this.err = err;\n\t\n\t\t\t_this.isResponded_ = false;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Message, [{\n\t\t\tkey: 'setId',\n\t\t\tvalue: function setId() {\n\t\t\t\tvar id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : uuid.v4();\n\t\n\t\t\t\tthis.id = id;\n\t\t\t\treturn id;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'createResponse',\n\t\t\tvalue: function createResponse(err, payload) {\n\t\t\t\treturn new Message({ name: '_r', payload: payload, err: err, id: this.id });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'resolve',\n\t\t\tvalue: function resolve(payload) {\n\t\t\t\tif ((0, _isUndefined2.default)(this.id)) return console.warn('[line] A message without an id cannot be resolved.');\n\t\n\t\t\t\tif (this.isResponded_) return console.warn('[line] This message has already been ended.');\n\t\n\t\t\t\tthis.isResponded_ = true;\n\t\t\t\tthis.emit('resolved', payload);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'reject',\n\t\t\tvalue: function reject(err) {\n\t\t\t\tif ((0, _isUndefined2.default)(this.id)) return console.warn('[line] A message without an id cannot be rejected.');\n\t\n\t\t\t\tif (this.isResponded_) return console.warn('[line] This message has already been ended.');\n\t\n\t\t\t\tthis.isResponded_ = true;\n\t\t\t\tthis.emit('rejected', err);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'toString',\n\t\t\tvalue: function toString() {\n\t\t\t\ttry {\n\t\t\t\t\tvar data = { n: this.name };\n\t\n\t\t\t\t\tif (!(0, _isUndefined2.default)(this.payload)) data.p = this.payload;\n\t\n\t\t\t\t\tif (!(0, _isUndefined2.default)(this.id)) data.i = this.id;\n\t\n\t\t\t\t\tif (!(0, _isUndefined2.default)(this.err)) data.e = this.err;\n\t\n\t\t\t\t\treturn JSON.stringify(data);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tthrow new Error('Could not stringify message.');\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'dispose',\n\t\t\tvalue: function dispose() {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tvar events = this.eventNames();\n\t\t\t\tevents.forEach(function (event) {\n\t\t\t\t\treturn _this2.removeAllListeners(event);\n\t\t\t\t});\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Message;\n\t}(_eventEmitterExtra2.default);\n\t\n\texports.default = Message;\n\t\n\t\n\tMessage.reservedNames = ['_r'];\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"lodash/isUndefined\");\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"node-uuid\");\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"uws\");\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// client-node.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e2f551946c8e2722350e","import WebSocket from 'uws';\nimport Message from '../lib/message';\nimport EventEmitter from 'event-emitter-extra';\n\n\nclass Client extends EventEmitter {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tthis.promiseCallbacks = {};\n\t\tthis.options = options;\n\t}\n\n\tconnect(url = 'localhost') {\n\t\tthis.ws = new WebSocket(url, this.options);\n\t\tthis.readyState = this.ws.readyState;\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents() {\n\t\tthis.ws.on('open', this.onOpen.bind(this));\n\t\tthis.ws.on('close', this.onClose.bind(this));\n\t\tthis.ws.on('error', this.onError.bind(this));\n\t\tthis.ws.on('message', this.onMessage.bind(this));\n\t}\n\n\tonOpen() {\n\t\tthis.readyState = this.ws.readyState;\n\t\tthis.emit('_open');\n\t}\n\n\n\tonClose(code, message) {\n\t\tthis.readyState = this.ws.readyState;\n\t\tthis.emit('_close', code, message);\n\t}\n\n\tonError(err) {\n\t\tthis.readyState = this.ws.readyState;\n\t\tthis.emit('_error', err);\n\t}\n\n\tonMessage(data, flags) {\n\t\tconst message = Message.parse(data);\n\n\t\t// Message without response (no id fields)\n\t\tif (!message.id && Message.reservedNames.indexOf(message.name) == -1)\n\t\t\treturn this.emit(message.name, message);\n\n\t\t// Message response\n\t\tif (message.name == '_r') {\n\t\t\tconst {resolve, reject} = this.promiseCallbacks[message.id];\n\n\t\t\tif (message.err) {\n\t\t\t\tconst err = _.assign(new Error(), message.err);\n\t\t\t\treject(err);\n\t\t\t} else {\n\t\t\t\tresolve(message.payload);\n\t\t\t}\n\n\t\t\tdelete this.promiseCallbacks[message.id];\n\t\t\treturn;\n\t\t}\n\n\t\t// Message with response\n\t\tmessage.once('resolved', payload => {\n\t\t\tthis.send_(message.createResponse(null, payload));\n\t\t\tmessage.dispose();\n\t\t});\n\n\t\tmessage.once('rejected', err => {\n\t        if (_.isObject(err) && err instanceof Error && err.name == 'Error')\n\t           err = {message: err.message, name: 'Error'};\n\t\t\tthis.send_(message.createResponse(err));\n\t\t\tmessage.dispose();\n\t\t});\n\n\t\tthis.emit(message.name, message);\n\t}\n\n\tsend(eventName, payload) {\n\t\tconst message = new Message({name: eventName, payload});\n\t\tconst messageId = message.setId();\n\t\treturn this\n\t\t\t.send_(message)\n\t\t\t.then(_ => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.promiseCallbacks[messageId] = {resolve, reject};\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tsend_(message) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.ws.send(message.toString(), err => {\n\t\t\t\tif (err) return reject(err);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n}\n\nmodule.exports = Client;\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/client-node.js","module.exports = require(\"event-emitter-extra\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"event-emitter-extra\"\n// module id = 1\n// module chunks = 0","import isUndefined from 'lodash/isUndefined';\nimport * as uuid from 'node-uuid';\nimport EventEmitter from 'event-emitter-extra';\n\n\n\nexport default class Message extends EventEmitter {\n\tstatic parse(raw) {\n\t\ttry {\n\t\t\tconst data = JSON.parse(raw);\n\t\t\treturn new Message({\n\t\t\t\tname: data.n,\n\t\t\t\tpayload: data.p,\n\t\t\t\terr: data.e,\n\t\t\t\tid: data.i\n\t\t\t});\n\t\t} catch(err) {\n\t\t\tthrow new Error(`Could not parse message.`);\n\t\t}\n\t}\n\n\tconstructor({name, payload, id, err}) {\n\t\tsuper();\n\n\t\tthis.name = name;\n\t\tthis.payload = payload;\n\t\tthis.id = id;\n\t\tthis.err = err;\n\n\t\tthis.isResponded_ = false;\n\t}\n\n\tsetId(id = uuid.v4()) {\n\t\tthis.id = id;\n\t\treturn id;\n\t}\n\n\tcreateResponse(err, payload) {\n\t\treturn new Message({name: '_r', payload, err, id: this.id});\n\t}\n\n\tresolve(payload) {\n\t\tif (isUndefined(this.id))\n\t\t\treturn console.warn('[line] A message without an id cannot be resolved.');\n\n\t\tif (this.isResponded_)\n\t\t\treturn console.warn('[line] This message has already been ended.');\n\n\t\tthis.isResponded_ = true;\n\t\tthis.emit('resolved', payload);\n\t}\n\n\treject(err) {\n\t\tif (isUndefined(this.id))\n\t\t\treturn console.warn('[line] A message without an id cannot be rejected.');\n\n\t\tif (this.isResponded_)\n\t\t\treturn console.warn('[line] This message has already been ended.');\n\n\t\tthis.isResponded_ = true;\n\t\tthis.emit('rejected', err);\n\t}\n\n\ttoString() {\n\t\ttry {\n\t\t\tconst data = {n: this.name};\n\n\t\t\tif (!isUndefined(this.payload))\n\t\t\t\tdata.p = this.payload;\n\n\t\t\tif (!isUndefined(this.id))\n\t\t\t\tdata.i = this.id;\n\n\t\t\tif (!isUndefined(this.err))\n\t\t\t\tdata.e = this.err;\n\n\t\t\treturn JSON.stringify(data);\n\t\t} catch(err) {\n\t\t\tthrow new Error(`Could not stringify message.`);\n\t\t}\n\t}\n\n\tdispose() {\n\t\tconst events = this.eventNames();\n\t\tevents.forEach(event => this.removeAllListeners(event));\n\t}\n}\n\nMessage.reservedNames = ['_r'];\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/message.js","module.exports = require(\"lodash/isUndefined\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/isUndefined\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"node-uuid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"node-uuid\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"uws\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uws\"\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}