{"version":3,"sources":["webpack:///webpack/bootstrap 62b943a4c7afe0dafec3","webpack:///./src/lib/utils.js","webpack:///external \"event-emitter-extra/dist/commonjs.modern\"","webpack:///./src/client/client-web.js","webpack:///external \"uws\"","webpack:///./src/lib/deferred.js","webpack:///./src/lib/message.js","webpack:///external \"lodash/assign\"","webpack:///external \"lodash/debounce\"","webpack:///external \"lodash/isFunction\"","webpack:///external \"lodash/isObject\"","webpack:///external \"lodash/isUndefined\"","webpack:///external \"lodash/values\"","webpack:///./src/client/client-node.js"],"names":["promiseDelay","ms","Promise","setTimeout","resolve","retry","task","options","defaults","maxDelay","maxCount","initialDelay","increaseFactor","timeout","counter","delay","once","catch","clearTimeout","err","then","generateDummyId","length","Math","random","pow","toString","slice","module","exports","WebClient","url","ws_","id","readyState","reconnect","serverTimeout_","maxReconnectDelay","initialReconnectDelay","reconnectIncrementFactor","pingInterval","deferreds_","connectDeferred_","disconnectDeferred_","state","States","READY","autoPing_","CONNECTED","ping","CONNECTING","reject","Error","CLOSING","CLOSED","handler","emit","Events","WebSocket","bindEvents_","code","reason","ERROR","deferred","close","onopen","onOpen","bind","onclose","onClose","onerror","onError","onmessage","onMessage","send","Names","HANDSHAKE","handshakePayload","data","console","log","disconnect","e","unBindEvents_","retrying_","connect","eventName","CONNECTING_ERROR","disposeConnectionPromisses_","message","parse","ReservedNames","indexOf","name","PING","onPing_","RESPONSE","Object","assign","payload","send_","createResponse","dispose","_","isObject","setId","onExpire","Deferred","resolve_","reject_","timeout_","onExpire_","isFinished_","promise","expire","clearTimeout_","args","apply","Message","raw","JSON","n","p","i","isResponded_","warn","stringify","events","eventNames","forEach","removeAllListeners","event","global","NodeClient","on"],"mappings":"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","file":"client-node.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 12);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 62b943a4c7afe0dafec3","import assign from 'lodash/assign';\n\n\nfunction promiseDelay(ms) {\n\treturn new Promise(resolve => setTimeout(_ => resolve(), ms))\n}\n\n\nfunction retry(task, options = {}) {\n\tconst defaults = {maxDelay: 160, maxCount: 0, initialDelay: 3, increaseFactor: 2};\n\toptions = assign(defaults, options);\n\tlet timeout;\n\tlet counter = 1;\n\tlet delay = options.initialDelay;\n\n\tconst once = function() {\n\t\treturn task()\n\t\t\t.catch(err => {\n\t\t\t\tcounter++;\n\t\t\t\tdelay = delay * options.increaseFactor;\n\n\t\t\t\tif (options.maxCount != 0 && counter > options.maxCount) {\n\t\t\t\t\ttimeout && clearTimeout(timeout);\n\t\t\t\t\tthrow err;\n\t\t\t\t}\n\t\t\t\treturn promiseDelay(delay * 1000 / 2).then(_ => once());\n\t\t\t});\n\t}\n\n\treturn once();\n}\n\n\n// http://stackoverflow.com/a/6248722\nfunction generateDummyId(length = 4) {\n\treturn (\"0000\" + (Math.random()*Math.pow(36,length) << 0).toString(36)).slice(-length);\n}\n\n\nmodule.exports = {promiseDelay, retry, generateDummyId};\n\n\n// WEBPACK FOOTER //\n// ./src/lib/utils.js","module.exports = require(\"event-emitter-extra/dist/commonjs.modern\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"event-emitter-extra/dist/commonjs.modern\"\n// module id = 1\n// module chunks = 0","import Message from '../lib/message';\nimport Utils from '../lib/utils';\nimport EventEmitter from 'event-emitter-extra/dist/commonjs.modern';\nimport Deferred from '../lib/deferred';\nimport debounce from 'lodash/debounce';\n\n\nclass WebClient extends EventEmitter {\n\tconstructor(url = 'ws://localhost', options = {}) {\n\t\tsuper();\n\n\t\tthis.url = url;\n\n\t\tthis.options = options;\n\n\t\tthis.ws_ = null;\n\t\tthis.id = null;\n\t\tthis.readyState = null;\n\t\tthis.reconnect = options.reconnect;\n\n\t\tthis.serverTimeout_ = 30000;\n\t\tthis.maxReconnectDelay = 60;\n\t\tthis.initialReconnectDelay = 1;\n\t\tthis.reconnectIncrementFactor = 2;\n\t\tthis.pingInterval = 60000;\n\n\t\tthis.deferreds_ = {};\n\t\tthis.connectDeferred_ = null;\n\t\tthis.disconnectDeferred_ = null;\n\n\t\tthis.state = WebClient.States.READY;\n\n\t\tthis.autoPing_ = this.pingInterval > 0 ?\n\t\t\tdebounce(() => {\n\t\t\t\tif (this.state != WebClient.States.CONNECTED)\n\t\t\t\t\treturn;\n\n\t\t\t\tthis\n\t\t\t\t\t.ping()\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tif (this.pingInterval > 0 && this.state == WebClient.States.CONNECTED) {\n\t\t\t\t\t\t\tthis.autoPing_();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {});\n\t\t\t}, this.pingInterval) :\n\t\t\t() => {};\n\t}\n\n\n\tconnect() {\n\t\tswitch (this.state) {\n\t\t\tcase WebClient.States.CONNECTING:\n\t\t\t\treturn Promise.reject(new Error('Could not connect, already trying to connect to a host...'));\n\t\t\tcase WebClient.States.CONNECTED:\n\t\t\t\treturn Promise.reject(new Error('Already connected.'));\n\t\t\tcase WebClient.States.CLOSING:\n\t\t\t\treturn Promise.reject(new Error('Terminating an active connecting, try again later.'));\n\t\t\tcase WebClient.States.CLOSED:\n\t\t\tcase WebClient.States.READY:\n\t\t\t\tthis.connectDeferred_ = new Deferred({\n\t\t\t\t\thandler: () => {\n\t\t\t\t\t\tthis.state = WebClient.States.CONNECTING;\n\t\t\t\t\t\tthis.emit(WebClient.Events.CONNECTING);\n\n\t\t\t\t\t\tsetTimeout(_ => {\n\t\t\t\t\t\t\tthis.ws_ = new WebSocket(this.url);\n\t\t\t\t\t\t\tthis.bindEvents_();\n\t\t\t\t\t\t}, 0);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn this.connectDeferred_;\n\t\t\tdefault:\n\t\t\t\treturn Promise.reject(new Error('Could not connect, unknown state.'))\n\t\t}\n\t}\n\n\n\tdisconnect(code, reason) {\n\t\tswitch (this.state) {\n\t\t\tcase WebClient.States.ERROR:\n\t\t\tcase WebClient.States.CONNECTED:\n\t\t\tcase WebClient.States.CONNECTING:\n\t\t\t\tconst deferred = this.disconnectDeferred_ = new Deferred({\n\t\t\t\t\thandler: () => {\n\t\t\t\t\t\tthis.ws_.close(code, reason);\n\t\t\t\t\t\tthis.state = WebClient.States.CLOSING;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn deferred;\n\t\t\tcase WebClient.States.CLOSED:\n\t\t\t\treturn Promise.reject(new Error('There is no connection to disconnect.'));\n\t\t\tcase WebClient.States.CLOSING:\n\t\t\t\treturn Promise.reject(new Error('Already terminating a connecting, try again later.'));\n\t\t}\n\t}\n\n\n\tbindEvents_() {\n\t\tthis.ws_.onopen = this.onOpen.bind(this);\n\t\tthis.ws_.onclose = this.onClose.bind(this);\n\t\tthis.ws_.onerror = this.onError.bind(this);\n\t\tthis.ws_.onmessage = this.onMessage.bind(this);\n\t}\n\n\n\tunBindEvents_() {\n\t\tif (!this.ws_) return;\n\t\tdelete this.ws_.onopen;\n\t\tdelete this.ws_.onclose;\n\t\tdelete this.ws_.onerror;\n\t\tdelete this.ws_.onmessage;\n\t}\n\n\n\tdisposeConnectionPromisses_() {\n\t\tif (this.connectDeferred_) {\n\t\t\tthis.connectDeferred_.reject();\n\t\t\tthis.connectDeferred_ = null;\n\t\t}\n\n\t\tif (this.disconnectDeferred_) {\n\t\t\tthis.disconnectDeferred_.reject();\n\t\t\tthis.disconnectDeferred_ = null;\n\t\t}\n\t}\n\n\n\tonOpen() {\n\t\t// this.updateState_();\n\t\t// this.emit('_open');\n\t\tUtils.retry(_ => this.send(Message.Names.HANDSHAKE, this.options.handshakePayload), {maxCount: 3, initialDelay: 1, increaseFactor: 1})\n\t\t\t.then(data => {\n\t\t\t\tthis.id = data.id;\n\t\t\t\tthis.serverTimeout_ = data.timeout;\n\t\t\t\tthis.maxReconnectDelay = data.maxReconnectDelay;\n\t\t\t\tthis.initialReconnectDelay = data.initialReconnectDelay;\n\t\t\t\tthis.reconnectIncrementFactor = data.reconnectIncrementFactor;\n\t\t\t\tthis.pingInterval = data.pingInterval;\n\n\t\t\t\tif (this.connectDeferred_) {\n\t\t\t\t\tthis.connectDeferred_.resolve(data.handshakePayload);\n\t\t\t\t\tthis.connectDeferred_ = null;\n\t\t\t\t}\n\n\t\t\t\tthis.state = WebClient.States.CONNECTED;\n\t\t\t\tthis.emit(WebClient.Events.CONNECTED, data.handshakePayload);\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.log('Handshake failed', err);\n\t\t\t\treturn this.disconnect();\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.log('Could not disconnect after failed handshake', err);\n\t\t\t});\n\t}\n\n\n\tonClose(e) {\n\t\tthis.unBindEvents_();\n\t\tthis.id = null;\n\t\tthis.ws_ = null;\n\t\tthis.state = WebClient.States.CLOSED;\n\n\t\tthis.emit(WebClient.Events.CLOSED, e.code, e.reason);\n\n\t\tif (this.connectDeferred_) {\n\t\t\tthis.connectDeferred_.reject();\n\t\t\tthis.connectDeferred_ = null;\n\t\t}\n\n\t\tif (this.disconnectDeferred_) {\n\t\t\tthis.disconnectDeferred_.resolve();\n\t\t\tthis.disconnectDeferred_ = null;\n\t\t}\n\n\t\tif (!this.reconnect || this.retrying_) return;\n\n\t\tthis.retrying_ = true;\n\t\tUtils\n\t\t\t.retry(\n\t\t\t\t_ => this.connect(),\n\t\t\t\t{\n\t\t\t\t\tmaxCount: this.maxReconnectDelay,\n\t\t\t\t\tinitialDelay: this.initialReconnectDelay,\n\t\t\t\t\tincreaseFactor: this.reconnectIncrementFactor\n\t\t\t\t})\n\t\t\t.then(_ => {\n\t\t\t\tthis.retrying_ = false;\n\t\t\t});\n\t}\n\n\n\tonError(err) {\n\t\tconst eventName = this.state == WebClient.States.CONNECTING ?\n\t\t\t\tWebClient.Events.CONNECTING_ERROR : WebClient.Events.ERROR;\n\n\t\tthis.state = WebClient.States.CLOSED;\n\n\t\tthis.emit(eventName, err);\n\t\tthis.disposeConnectionPromisses_();\n\t}\n\n\n\tonMessage(e) {\n\t\tconst message = Message.parse(e.data);\n\n\t\tthis.autoPing_();\n\n\t\t// Message without response (no id fields)\n\t\tif (!message.id && Message.ReservedNames.indexOf(message.name) == -1)\n\t\t\treturn this.emit(message.name, message);\n\n\t\t// Ping\n\t\tif (message.name == Message.Names.PING) {\n\t\t\treturn this.onPing_(message);\n\t\t}\n\n\t\t// Message response\n\t\tif (message.name == Message.Names.RESPONSE && this.deferreds_[message.id]) {\n\t\t\tconst deferred = this.deferreds_[message.id];\n\n\t\t\tif (message.err) {\n\t\t\t\tconst err = Object.assign(new Error(), message.err);\n\t\t\t\tdeferred.reject(err);\n\t\t\t} else {\n\t\t\t\tdeferred.resolve(message.payload);\n\t\t\t}\n\n\t\t\tdelete this.deferreds_[message.id];\n\t\t\treturn;\n\t\t}\n\n\t\t// Message with response\n\t\tmessage.once('resolved', payload => {\n\t\t\tthis.send_(message.createResponse(null, payload));\n\t\t\tmessage.dispose();\n\t\t});\n\n\t\tmessage.once('rejected', err => {\n\t        if (_.isObject(err) && err instanceof Error && err.name == 'Error')\n\t           err = {message: err.message, name: 'Error'};\n\t\t\tthis.send_(message.createResponse(err));\n\t\t\tmessage.dispose();\n\t\t});\n\n\t\tthis.emit(message.name, message);\n\t}\n\n\n\tonPing_(message) {\n\t\tthis\n\t\t\t.send_(message.createResponse(null, 'pong'))\n\t\t\t.catch(err => {\n\t\t\t\tconsole.log('Ping responce failed to send', err);\n\t\t\t});\n\t}\n\n\n\tsend(eventName, payload) {\n\t\tconst message = new Message({name: eventName, payload});\n\t\tmessage.setId();\n\n\t\treturn this\n\t\t\t.send_(message)\n\t\t\t.then(_ => {\n\t\t\t\tconst deferred = this.deferreds_[message.id] = new Deferred({\n\t\t\t\t\tonExpire: () => {\n\t\t\t\t\t\tdelete this.deferreds_[message.id];\n\t\t\t\t\t},\n\t\t\t\t\ttimeout: this.serverTimeout_\n\t\t\t\t});\n\n\t\t\t\treturn deferred;\n\t\t\t});\n\t}\n\n\n\tsendWithoutResponse(eventName, payload) {\n\t\tconst message = new Message({name: eventName, payload});\n\t\treturn this.send_(message);\n\t}\n\n\n\tsend_(message) {\n\t\treturn new Promise(resolve => {\n\t\t\tthis.ws_.send(message.toString());\n\t\t\tresolve();\n\t\t});\n\t}\n\n\n\tping() {\n\t\treturn Utils\n\t\t\t.retry(_ => this.send(Message.Names.PING), {maxCount: 3, initialDelay: 1, increaseFactor: 1})\n\t\t\t.catch(err => {\n\t\t\t\tthis.disconnect();\n\t\t\t\tthrow err;\n\t\t\t});\n\t}\n}\n\nWebClient.States = {\n\tREADY: -1,\n\tCONNECTING: 0,\n\tCONNECTED: 1,\n\tCLOSING: 2,\n\tCLOSED: 3\n};\n\nWebClient.Events = {\n\tREADY: '_ready',\n\tCONNECTING: '_connecting',\n\tCONNECTING_ERROR: '_connecting_error',\n\tCONNECTED: '_connected',\n\tCLOSING: '_closing',\n\tCLOSED: '_closed',\n\tERROR: '_error'\n};\n\n\nmodule.exports = WebClient;\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/client-web.js","module.exports = require(\"uws\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uws\"\n// module id = 3\n// module chunks = 0","class Deferred {\n    constructor({\n        handler = () => {},\n        onExpire = () => {},\n        timeout = 0\n    } = {}) {\n        this.resolve_ = null;\n        this.reject_ = null;\n\n        this.timeout_ = null;\n        this.onExpire_ = onExpire;\n        this.isFinished_ = false;\n\n        this.promise = new Promise((resolve, reject) => {\n            this.resolve_ = resolve;\n            this.reject_ = reject;\n\n            try {\n                handler(this);\n            } catch (err) {\n                this.reject(err);\n            }\n        });\n\n        if (timeout > 0) {\n            this.timeout_ = setTimeout(this.expire.bind(this), timeout);\n        }\n    }\n\n\n    resolve(data) {\n        if (this.isFinished_) return;\n\n        this.isFinished_ = true;\n        this.clearTimeout_();\n        this.resolve_(data);\n    }\n\n\n    reject(err) {\n        if (this.isFinished_) return;\n\n        this.isFinished_ = true;\n        this.clearTimeout_();\n        this.reject_(err);\n    }\n\n\n    expire() {\n        this.isFinished_ = true;\n        this.clearTimeout_();\n        this.onExpire_();\n        this.reject_(new Error('Timeout exceed'));\n    }\n\n\n    then(...args) {\n        return this.promise.then.apply(this.promise, args);\n    }\n\n\n    catch(...args) {\n        return this.promise.catch.apply(this.promise, args);\n    }\n\n\n    clearTimeout_() {\n        if (this.timeout_) {\n            clearTimeout(this.timeout_);\n            this.timeout_ = null;\n        }\n    }\n}\n\n\nmodule.exports = Deferred;\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/deferred.js","import isUndefined from 'lodash/isUndefined';\nimport isObject from 'lodash/isObject';\nimport isFunction from 'lodash/isFunction';\nimport values from 'lodash/values';\nimport {generateDummyId} from './utils';\nimport EventEmitter from 'event-emitter-extra/dist/commonjs.modern';\n\n\n\nexport default class Message extends EventEmitter {\n\tstatic parse(raw) {\n\t\ttry {\n\t\t\tconst data = JSON.parse(raw);\n\t\t\treturn new Message({\n\t\t\t\tname: data.n,\n\t\t\t\tpayload: data.p,\n\t\t\t\terr: data.e,\n\t\t\t\tid: data.i\n\t\t\t});\n\t\t} catch(err) {\n\t\t\tthrow new Error(`Could not parse message.`);\n\t\t}\n\t}\n\n\tconstructor({name, payload, id, err}) {\n\t\tsuper();\n\n\t\tthis.name = name;\n\t\tthis.payload = payload;\n\t\tthis.id = id;\n\t\tthis.err = err;\n\n\t\tthis.isResponded_ = false;\n\t}\n\n\tsetId(id = generateDummyId()) {\n\t\tthis.id = id;\n\t\treturn id;\n\t}\n\n\tcreateResponse(err, payload) {\n\t\treturn new Message({name: '_r', payload, err, id: this.id});\n\t}\n\n\tresolve(payload) {\n\t\tif (isUndefined(this.id))\n\t\t\treturn console.warn('[line] A message without an id cannot be resolved.');\n\n\t\tif (this.isResponded_)\n\t\t\treturn console.warn('[line] This message has already been ended.');\n\n\t\t// If thenable\n\t\tif (isObject(payload) && isFunction(payload.then)) {\n\t\t\tpayload\n\t\t\t\t.then(response => {\n\t\t\t\t\tthis.isResponded_ = true;\n\t\t\t\t\tthis.emit('resolved', payload);\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tthis.isResponded_ = true;\n\t\t\t\t\tthis.emit('rejected', err);\n\t\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isResponded_ = true;\n\t\tthis.emit('resolved', payload);\n\t}\n\n\treject(err) {\n\t\tif (isUndefined(this.id))\n\t\t\treturn console.warn('[line] A message without an id cannot be rejected.');\n\n\t\tif (this.isResponded_)\n\t\t\treturn console.warn('[line] This message has already been ended.');\n\n\t\tthis.isResponded_ = true;\n\t\tthis.emit('rejected', err);\n\t}\n\n\ttoString() {\n\t\ttry {\n\t\t\tconst data = {n: this.name};\n\n\t\t\tif (!isUndefined(this.payload))\n\t\t\t\tdata.p = this.payload;\n\n\t\t\tif (!isUndefined(this.id))\n\t\t\t\tdata.i = this.id;\n\n\t\t\tif (!isUndefined(this.err))\n\t\t\t\tdata.e = this.err;\n\n\t\t\treturn JSON.stringify(data);\n\t\t} catch(err) {\n\t\t\tthrow new Error(`Could not stringify message.`);\n\t\t}\n\t}\n\n\tdispose() {\n\t\tconst events = this.eventNames();\n\t\tevents.forEach(event => this.removeAllListeners(event));\n\t}\n}\n\n\nMessage.Names = {\n\tRESPONSE: '_r',\n\tHANDSHAKE: '_h',\n\tPING: '_p'\n};\n\n\nMessage.ReservedNames = values(Message.Names);\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/message.js","module.exports = require(\"lodash/assign\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/assign\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"lodash/debounce\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/debounce\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"lodash/isFunction\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/isFunction\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"lodash/isObject\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/isObject\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"lodash/isUndefined\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/isUndefined\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"lodash/values\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/values\"\n// module id = 11\n// module chunks = 0","import WebSocket from 'uws';\nimport WebClient from './client-web';\nglobal.WebSocket = WebSocket;\n\n\nclass NodeClient extends WebClient {\n\tbindEvents_() {\n\t\tthis.ws_.on('open', this.onOpen.bind(this));\n\t\tthis.ws_.on('error', this.onError.bind(this));\n\n\t\tthis.ws_.on('close', (code, reason) => {\n\t\t\tthis.onClose({code, reason});\n\t\t});\n\n\t\tthis.ws_.on('message', (data) => {\n\t\t\tthis.onMessage({data});\n\t\t});\n\t}\n\n\n\tsend_(message) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.ws_.send(message.toString(), err => {\n\t\t\t\tif (err) return reject(err);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n}\n\n\nmodule.exports = NodeClient;\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/client-node.js"],"sourceRoot":""}