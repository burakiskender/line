{"version":3,"sources":["webpack:///webpack/bootstrap cc00901ce879f71afa30","webpack:///./src/server/server.js","webpack:///external \"uws\"","webpack:///./src/server/connection.js","webpack:///./src/lib/message.js","webpack:///external \"lodash\"","webpack:///external \"node-uuid\"","webpack:///./src/server/rooms.js","webpack:///external \"event-emitter-extra\""],"names":["Server","options","rooms","port","server","bindEvents","Promise","resolve","reject","err","on","onConnection","bind","socket","connection","emit","module","exports","_","uuid","Connection","promiseCallbacks","onMessage","onError","onClose","onPing","onPong","data","flags","message","parse","id","reservedNames","indexOf","name","assign","Error","payload","once","send_","createResponse","isObject","error","code","removeFromAll","forEach","callbacks","joinRoom","roomName","add","remove","getRoomsOf","eventName","messageId","setId","then","send","toString","Message","raw","JSON","n","p","e","i","isResponded_","v4","isUndefined","stringify","console","warn","Rooms","isEmpty","keys","filter","connections","room"],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap cc00901ce879f71afa30","import {Server as WebSocketServer} from 'uws';\nimport Connection from './connection';\nimport Rooms from './rooms';\nimport EventEmitter from 'event-emitter-extra';\n\n\nclass Server extends EventEmitter {\n\tconstructor(options) {\n\t\tsuper();\n\t\tthis.rooms = new Rooms();\n\t\tthis.options = options;\n\t}\n\n\tstart() {\n\t\tif (!this.options.port) {\n\t\t\tthis.server = new WebSocketServer(this.options);\n\t\t\tthis.bindEvents();\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.server = new WebSocketServer(this.options, err => {\n\t\t\t\tif (err) return reject(err);\n\t\t\t\tthis.bindEvents();\n\t\t\t\tresolve();\n\t\t\t});\n\t\t})\n\t}\n\n\tbindEvents() {\n\t\tthis.server.on('connection', this.onConnection.bind(this));\n\t}\n\n\tonConnection(socket) {\n\t\tconst connection = new Connection(socket, this);\n\t\tthis.emit('connection', connection);\n\t}\n\n\n}\n\nmodule.exports = Server;\n\n\n// WEBPACK FOOTER //\n// ./src/server/server.js","module.exports = require(\"uws\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uws\"\n// module id = 1\n// module chunks = 0","import Message from '../lib/message';\nimport EventEmitter from 'event-emitter-extra';\nimport * as _ from 'lodash';\nimport * as uuid from 'node-uuid';\n\n\nclass Connection extends EventEmitter {\n\tconstructor(socket, server) {\n\t\tsuper();\n\n\t\tthis.socket = socket;\n\t\tthis.server = server;\n\n\t\tthis.promiseCallbacks = {};\n\t\t// this.id = uuid.v4();\n\t\tthis.socket.on('message', this.onMessage.bind(this));\n\t\tthis.socket.on('error', this.onError.bind(this));\n\t\tthis.socket.on('close', this.onClose.bind(this));\n\t\tthis.socket.on('ping', this.onPing.bind(this));\n\t\tthis.socket.on('pong', this.onPong.bind(this));\n\t\t//this.socket.on('open', this.onOpen.bind(this));\n\t}\n\n\n\tonMessage(data, flags) {\n\t\tconst message = Message.parse(data);\n\n\t\t// Ciplak mesaj, publish\n\t\tif (!message.id && Message.reservedNames.indexOf(message.name) == -1)\n\t\t\treturn this.emit(message.name, message);\n\n\t\t// Bize response geliyor\n\n\t\tif (message.name == '_r') {\n\t\t\tconst {resolve, reject} = this.promiseCallbacks[message.id];\n\n\t\t\tif (message.err) {\n\t\t\t\tconst err = _.assign(new Error(), message.err);\n\t\t\t\treject(err);\n\t\t\t} else {\n\t\t\t\tresolve(message.payload);\n\t\t\t}\n\n\t\t\tdelete this.promiseCallbacks[message.options.id];\n\t\t\treturn;\n\t\t}\n\n\t\t// Bizden response bekleniyor\n\n\t\tmessage.once('resolved', payload => {\n\t\t\tthis.send_(message.createResponse(null, payload));\n\t\t});\n\n\t\tmessage.once('rejected', err => {\n\t        if (_.isObject(err) && err instanceof Error && err.name == 'Error')\n\t           err = {message: err.message, name: 'Error'};\n\t\t\tthis.send_(message.createResponse(err));\n\t\t});\n\n\t\tthis.emit(message.name, message);\n\t}\n\n\tonError(error) {\n\t\tthis.emit('error', error);\n\t}\n\n\tonClose(code, message) {\n\t\tthis.server.rooms.removeFromAll(this);\n\n\t\t_.forEach(this.promiseCallbacks, (callbacks) => {\n\t\t\tcallbacks.reject(new Error('Socket connection closed!'));\n\t\t});\n\t\tthis.promiseCallbacks = {};\n\n\t\tthis.emit('_close', code, message);\n\t}\n\n\tonPing(data, flags) {\n\t\tthis.emit('_ping', data, flags);\n\t}\n\n\tonPong(data, flags) {\n\t\tthis.emit('_pong', data, flags);\n\t}\n\n\tonOpen() {\n\t\tthis.joinRoom('/');\n\t\tthis.emit('_open');\n\t}\n\n\n\tjoinRoom(roomName) {\n\t\tthis.server.rooms.add(roomName, this);\n\t}\n\n\n\tleaveRoom(roomName) {\n\t\tthis.server.rooms.remove(roomName, this);\n\t}\n\n\tgetRooms() {\n\t\tthis.server.rooms.getRoomsOf(this);\n\t}\n\n\tsend(eventName, payload) {\n\t\tconst message = new Message({name: eventName, payload});\n\t\tconst messageId = message.setId();\n\t\treturn this\n\t\t\t.send_(message)\n\t\t\t.then(_ => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.promiseCallbacks[messageId] = {resolve, reject};\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tsend_(message) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.socket.send(message.toString(), err => {\n\t\t\t\tif (err) return reject(err);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n}\n\nmodule.exports = Connection;\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/connection.js","import * as _ from 'lodash';\nimport * as uuid from 'node-uuid';\nimport EventEmitter from 'event-emitter-extra';\n\n\n\nexport default class Message extends EventEmitter {\n\tstatic parse(raw) {\n\t\ttry {\n\t\t\tconst data = JSON.parse(raw);\n\t\t\treturn new Message({\n\t\t\t\tname: data.n,\n\t\t\t\tpayload: data.p,\n\t\t\t\terr: data.e,\n\t\t\t\tid: data.i\n\t\t\t});\n\t\t} catch(err) {\n\t\t\tthrow new Error(`Could not parse message.`);\n\t\t}\n\t}\n\n\tconstructor({name, payload, id, err}) {\n\t\tsuper();\n\n\t\tthis.name = name;\n\t\tthis.payload = payload;\n\t\tthis.id = id;\n\t\tthis.err = err;\n\n\t\tthis.isResponded_ = false;\n\t}\n\n\tsetId(id = uuid.v4()) {\n\t\tthis.id = id;\n\t\treturn id;\n\t}\n\n\ttoString() {\n\t\ttry {\n\t\t\tconst data = {n: this.name};\n\n\t\t\tif (!_.isUndefined(this.payload))\n\t\t\t\tdata.p = this.payload;\n\n\t\t\tif (!_.isUndefined(this.id))\n\t\t\t\tdata.i = this.id;\n\n\t\t\tif (!_.isUndefined(this.err))\n\t\t\t\tdata.e = this.err;\n\n\t\t\treturn JSON.stringify(data);\n\t\t} catch(err) {\n\t\t\tthrow new Error(`Could not stringify message.`);\n\t\t}\n\t}\n\n\tcreateResponse(err, payload) {\n\t\treturn new Message({name: '_r', payload, err, id: this.id});\n\t}\n\n\tresolve(payload) {\n\t\tif (_.isUndefined(this.id))\n\t\t\treturn console.warn('[line] A message without an id cannot be resolved.');\n\n\t\tif (this.isResponded_)\n\t\t\treturn console.warn('[line] This message has already been ended.');\n\n\t\tthis.isResponded_ = true;\n\t\tthis.emit('resolved', payload);\n\t}\n\n\treject(err) {\n\t\tif (_.isUndefined(this.id))\n\t\t\treturn console.warn('[line] A message without an id cannot be rejected.');\n\n\t\tif (this.isResponded_)\n\t\t\treturn console.warn('[line] This message has already been ended.');\n\n\t\tthis.isResponded_ = true;\n\t\tthis.emit('rejected', err);\n\t}\n}\n\nMessage.reservedNames = ['_r'];\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/message.js","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"node-uuid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"node-uuid\"\n// module id = 5\n// module chunks = 0","import * as _ from 'lodash';\n\n\nexport default class Rooms {\n\tconstructor() {\n\t\tthis.rooms = {'/': {}};\n\t}\n\n\tadd(roomName, connection) {\n\t\tif(!this.rooms[roomName])\n\t\t\tthis.rooms[roomName] = {};\n\n\t\tthis.rooms[roomName][connection.id] = connection;\n\t}\n\n\tremove(roomName, connection) {\n\t\tif(!this.rooms[roomName])\n\t\t\treturn;\n\n\t\tdelete this.rooms[roomName][connection.id];\n\n\t\tif (roomName != '/' && _.isEmpty(this.rooms[roomName]))\n\t\t\tdelete this.rooms[roomName];\n\t}\n\n\tgetRoomsOf(connection) {\n\t\treturn _.keys(_.filter(this.rooms, connections => connections[connection.id]));\n\t}\n\n\tremoveFromAll(connection) {\n\t\tconst rooms = this.getRoomsOf(connection);\n\t\t_.forEach(rooms, room => this.remove(room, connection));\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/rooms.js","module.exports = require(\"event-emitter-extra\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"event-emitter-extra\"\n// module id = 8\n// module chunks = 0"],"sourceRoot":""}